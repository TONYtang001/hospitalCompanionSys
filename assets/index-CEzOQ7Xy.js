import{_ as R,u as A,a as H,r as p,b as v,o as O,m as G,c as J,d as K,E as Q,e as W,f as E,g as k,h as l,i as X,w as a,j as c,t as y,k as _,F as w,l as Z,n as ee,p as oe,q as te,s as le,v as ae,x as se,y as ne,z as ie}from"./index-Tg-uRf67.js";import{E as re,a as me,b as de,c as ue,d as pe,e as ce}from"./index-D89EUIvB.js";import{E as _e}from"./index-bNSnM5dT.js";const fe={class:"flex-box"},ge={style:{"margin-left":"10px"}},be={class:"pagination-info"},ve={class:"dialog-footer"},Ee={__name:"index",setup(ye){const z=A(),S=H(),r=p({pageNum:1,pageSize:10}),m=p({list:[],total:0}),f=v([]),N=o=>{const e=f.value.find(i=>i.id===o);return e?e.name:"超级管理员"};O(()=>{d(),G().then(({data:o})=>{console.log(o,"menuSelectList"),f.value=o.data})});const d=()=>{J(r).then(({data:o})=>{console.log(o,"authAdmin");const{list:e,total:i}=o.data;e.forEach(s=>{s.create_time=K(s.create_time).format("YYYY-MM-DD")}),m.list=e,m.total=i,o.code===1e4&&(Q.success(`${o.data.list[0].name}-${o.data.list[0].mobile}`),S.commit("setUserName",o.data.list[0].name))})},h=o=>{r.pageSize=o,d()},U=o=>{r.pageNum=o,d()},u=v(!1),C=()=>{u.value=!1,g.value.resetFields()},n=p({name:"",permissions_id:"",mobile:""}),g=v(),F=async o=>{o&&await o.validate((e,i)=>{e?ee({name:n.name,permissions_id:n.permissions_id}).then(s=>{s.data.code===1e4&&(C(),d())}):console.log("error submit!",i)})},B=p({name:[{required:!0,trigger:"blur",message:"请输入昵称"}],permissions_id:[{required:!0,trigger:"blur",message:"请选择权限角色"}]}),D=o=>{u.value=!0,Object.assign(n,{name:o.name,permissions_id:o.permissions_id,mobile:o.mobile})};return(o,e)=>{const i=oe,s=re,I=me,L=W("Clock"),M=te,V=le,T=de,Y=ue,x=ae,b=se,$=ce,j=pe,q=ne,P=_e;return E(),k(w,null,[l(i,{route:X(z)},null,8,["route"]),l(T,{data:m.list,style:{width:"100%"}},{default:a(()=>[l(s,{prop:"id",label:"id"}),l(s,{prop:"name",label:"昵称"}),l(s,{prop:"permissions_id",label:"所属组别"},{default:a(t=>[c(y(N(t.row.permissions_id)),1)]),_:1}),l(s,{prop:"mobile",label:"手机号"}),l(s,{prop:"active",label:"状态"},{default:a(t=>[l(I,{type:t.row.active?"success":"danger"},{default:a(()=>[c(y(t.row.active?"正常":"失效"),1)]),_:2},1032,["type"])]),_:1}),l(s,{prop:"create_time",label:"创建时间"},{default:a(t=>[_("div",fe,[l(M,null,{default:a(()=>[l(L)]),_:1}),_("span",ge,y(t.row.create_time),1)])]),_:1}),l(s,{label:"操作"},{default:a(t=>[l(V,{type:"primary",onClick:Ce=>D(t.row)},{default:a(()=>e[6]||(e[6]=[c(" edit ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),_("div",be,[l(Y,{"current-page":r.pageNum,"onUpdate:currentPage":e[0]||(e[0]=t=>r.pageNum=t),"page-size":r.pageSize,background:!1,size:"small",layout:"total, prev, pager, next, sizes",total:m.total,onSizeChange:h,onCurrentChange:U},null,8,["current-page","page-size","total"])]),l(P,{modelValue:u.value,"onUpdate:modelValue":e[5]||(e[5]=t=>u.value=t),"before-close":C,title:"添加权限",width:"500"},{footer:a(()=>[_("div",ve,[l(V,{type:"primary",onClick:e[4]||(e[4]=t=>F(g.value))},{default:a(()=>e[7]||(e[7]=[c(" Confirm ")])),_:1})])]),default:a(()=>[l(q,{ref_key:"formRef",ref:g,"label-width":"100px","label-position":"left",model:n,rules:B},{default:a(()=>[l(b,{label:"手机号",prop:"mobile"},{default:a(()=>[l(x,{modelValue:n.mobile,"onUpdate:modelValue":e[1]||(e[1]=t=>n.mobile=t),disabled:""},null,8,["modelValue"])]),_:1}),l(b,{label:"昵称",prop:"name"},{default:a(()=>[l(x,{modelValue:n.name,"onUpdate:modelValue":e[2]||(e[2]=t=>n.name=t)},null,8,["modelValue"])]),_:1}),l(b,{label:"菜单权限",prop:"permissions_id"},{default:a(()=>[l(j,{modelValue:n.permissions_id,"onUpdate:modelValue":e[3]||(e[3]=t=>n.permissions_id=t),placeholder:"请选择菜单权限",style:{width:"240px"}},{default:a(()=>[(E(!0),k(w,null,Z(f.value,t=>(E(),ie($,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},we=R(Ee,[["__scopeId","data-v-d90c4716"]]);export{we as default};
